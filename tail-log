#
#  Synopsis:
#	Tail today's log files for biod, flowd and sync processes.
#  Note:
#	Not correctly handling when "today" become "tomorrow".
#

die()
{
	echo "ERROR: $@" >&2
	exit 1
}

case $# in
0)
	START_DIRS=.
	;;
*)
	for H in $@;  do
		SYNC_DIR=sync/host/$H
		test -d $SYNC || die "sync directory does not exist: $SYNC_DIR"
		START_DIRS="$START_DIRS $SYNC_DIR"
	done
	;;
esac

test -n "$BLOBIO_ROOT" || die 'env not defined: BLOBIO_ROOT'
cd $BLOBIO_ROOT || die "cd blobio dir failed: $BLOBIO_ROOT: exit status=$?"

LOG_DIRS=$(find $START_DIRS -type d -name log)
echo "log dirs: $LOG_DIRS"
tail -F	$(find $LOG_DIRS -maxdepth 1 -name "*-$(date +%a).log")
